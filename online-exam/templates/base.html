{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}Online Exam System{% endblock %}</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9fa;
            min-height: 100vh;
            margin: 0;
            display: flex;
            /* layout should be column so footer can stick to bottom with margin-top:auto */
            flex-direction: column;
        }

        /* Sidebar */
.sidebar {
    width: 250px;
    background: linear-gradient(180deg, #007bff, #0056b3);
    min-height: 100vh;
    color: #fff;
    position: fixed;
    font-family: 'Poppins', sans-serif;
    border-right: 2px solid rgba(255, 255, 255, 0.2); 
    z-index: 1001; 
}

/* Sidebar Brand */
.sidebar .navbar-brand {
    font-weight: 700;         /* bolder for better visibility */
    color: #fff !important;
    font-size: 1.5rem;       /* adjusted size for better fit */
    line-height: 1.2;         /* tighter line height */
    font-family: 'Poppins', sans-serif;
    padding: 0.5rem 1rem;     /* consistent padding */
    margin: 0.5rem 0;         /* vertical spacing */
    text-align: left;
    width: 100%;              /* full width of sidebar */
    white-space: normal;      /* allow text wrap if needed */
    display: block;
    text-decoration: none;    
}

/* Sidebar Links */
.sidebar .nav-link {
    color: #fff;
    font-weight: 400;         /* more visible */
    font-size: 1.05rem;       /* bigger font size */
    padding: 14px 20px;       /* more spacing for click area */
    display: flex;
    align-items: center;
    transition: all 0.2s ease;
}

.sidebar .nav-link i {
    margin-right: 12px;       /* icon spacing */
    font-size: 1.2rem;        /* bigger icon */
}

.sidebar .nav-link:hover {
    background-color: rgba(255, 255, 255, 0.15);
    color: #ffd700;
}

.sidebar .nav-link.active {
    background-color: rgba(255, 255, 255, 0.25);
    color: #ffd700;
}

        /* Navbar */
        .top-navbar {
            height: 60px;
            background: linear-gradient(90deg, #007bff, #0056b3);
            position: fixed;
            top: 0;
            left: 250px;
            right: 0;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 0 20px;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .top-navbar .nav-link, .top-navbar .dropdown-toggle {
            color: #fff;
            font-weight: 500;
        }

     /* Main content */
 main {
            flex-grow: 1;
            padding: 80px 20px 20px 20px;
            max-width: 900px;
            margin-left: 270px; /* 250px sidebar + 20px spacing */
            top: 0; 
        }

/* Footer aligned with content */
 footer {
            background: linear-gradient(90deg, #007bff, #0056b3);
            color: white;
            text-align: center;
            padding: 12px 0;
            font-size: 0.9rem;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.15);
            margin-top: auto;
            width: calc(100% - 250px);
            margin-left: 250px;
        }


    </style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar d-flex flex-column pt-4">
    <a class="navbar-brand px-3 mb-4" href="{% url 'dashboard_home' %}">Online Exam System</a>
    {% if user.is_authenticated %}
            {% if user.user_type == 1 %}
                <!-- Admin Links -->
                <li class="nav-item"><a class="nav-link" href="{% url 'dashboard_home' %}">Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'questions_list' %}">Manage Questions</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'admin_users' %}">User Management</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'admin_activity' %}">All Reports</a></li>
            {% elif user.user_type == 2 %}
                <!-- Teacher Links -->
                <li class="nav-item"><a class="nav-link" href="{% url 'dashboard_home' %}">Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'questions_list' %}">Manage Questions</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'mock_test' %}">Manage Test</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'add_question' %}">Add Questions</a></li> 
                {% comment %} <li class="nav-item"><a class="nav-link" href="{% url 'review_questions' %}">Review Questions</a></li> {% endcomment %}
                <li class="nav-item"><a class="nav-link" href="{% url 'teacher_reports' %}">Students Results</a></li>
            {% elif user.user_type == 3 %}
                <!-- Student Links -->
                <li class="nav-item"><a class="nav-link" href="{% url 'dashboard_home' %}">Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'leaderboard' %}">Leaderboard</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'student_submissions' %}">My result</a></li>
            {% endif %}
        {% else %}
            <!-- Non-authenticated Links -->
            <li class="nav-item"><a class="nav-link" href="{% url 'login' %}">Login</a></li>
            <li class="nav-item"><a class="nav-link" href="{% url 'register' %}">Register</a></li>
        {% endif %}
</div>

<!-- Top Navbar -->
<nav class="top-navbar">
    {% if user.is_authenticated %}
    <ul class="navbar-nav ms-auto mb-0">
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="profileDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          <i class="fa-solid fa-user-circle fa-2x me-2"></i>
          {{ user.username }}
        </a>
        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
          <li>
            <a class="dropdown-item d-flex align-items-center" href="#">
              <i class="fa-solid fa-id-card me-2"></i>Profile
            </a>
          </li>
          <li><hr class="dropdown-divider"></li>
          <li>
            <a class="dropdown-item d-flex align-items-center text-danger" href="{% url 'logout' %}">
              <i class="fa-solid fa-right-from-bracket me-2"></i>Logout
            </a>
          </li>
        </ul>
      </li>
    </ul>
    {% endif %}
</nav>

<!-- Main Content -->
<div class="main-content">
    <main>
        {% block content %}
        {% endblock %}
    </main>
</div>

<!-- Footer -->
<footer>
    <small>&copy; {{ now|date:"Y" }} Online Exam System. All Rights Reserved.</small>
</footer>

<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
