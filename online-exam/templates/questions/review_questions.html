{% extends 'base.html' %}
{% load static %}
{% block title %}Review Questions{% endblock %}

{% block content %}
<style>
  .review-container {
    max-width: 1100px;
    margin: 30px auto;
    background: #fff;
    padding: 25px;
    border-radius: 15px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .review-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
  }

  .review-header h2 {
    font-weight: 600;
    color: #333;
  }

  .question-card {
    border: 1px solid #ddd;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    transition: all 0.2s ease;
  }

  .question-card:hover {
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
  }

  .question-text {
    font-size: 18px;
    font-weight: 500;
    color: #333;
  }

  .question-meta {
    font-size: 14px;
    color: #555;
    margin-top: 10px;
  }

  .status-section {
    display: flex;
    justify-content: flex-end;
    align-items: center;
    gap: 10px;
    margin-top: 10px;
  }

  .review-suggestion {
    margin-top: 15px;
    display: none;
  }

  .review-suggestion textarea {
    width: 100%;
    height: 80px;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 8px;
    resize: none;
  }

  .action-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 15px;
  }

  .btn-accept {
    background-color: #28a745;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
  }

  .btn-reject {
    background-color: #dc3545;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
  }

  .btn-accept:hover,
  .btn-reject:hover {
    opacity: 0.9;
  }
</style>

<div class="review-container">
  <div class="review-header">
    <h2>Review Questions</h2>
  </div>

  {% for question in questions %}
  <div class="question-card">
    <div class="question-text">
      {{ question.text }}
    </div>

    <div class="question-meta">
      <strong>Subject:</strong> {{ question.subject }} |
      <strong>Mode:</strong> {{ question.mode }} |
      <strong>By:</strong> {{ question.teacher.username }}
    </div>

    <div class="status-section">
      <label><strong>Status:</strong></label>
      <select class="status-dropdown" onchange="toggleSuggestion(this)">
        <option value="Approved" {% if question.status == 'Approved' %}selected{% endif %}>Approved</option>
        <option value="Pending" {% if question.status == 'Pending' %}selected{% endif %}>Pending</option>
        <option value="Needs Correction" {% if question.status == 'Needs Correction' %}selected{% endif %}>Needs Correction</option>
      </select>
    </div>

    <div class="review-suggestion">
      <label><strong>Review Suggestion:</strong></label>
      <textarea placeholder="Write your suggestions...">{{ question.review_suggestion }}</textarea>
    </div>

    <div class="action-buttons">
      <button class="btn-accept">Accept</button>
      <button class="btn-reject">Reject</button>
    </div>
  </div>
  {% empty %}
  <p>No questions available for review.</p>
  {% endfor %}
</div>

<script>
  function toggleSuggestion(selectEl) {
    const suggestionBox = selectEl.closest('.question-card').querySelector('.review-suggestion');
    if (selectEl.value === 'Needs Correction') {
      suggestionBox.style.display = 'block';
    } else {
      suggestionBox.style.display = 'none';
    }
  }
</script>

{% endblock %}
